<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download FMC Payments App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #6f42c1 0%, #4e54c8 100%); min-height: 100vh; }
        .download-card { background: white; border-radius: 1rem; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
        .app-icon { width: 120px; height: 120px; border-radius: 1rem; box-shadow: 0 4px 20px rgba(0,0,0,0.3); }
        .download-btn { padding: 1rem 2rem; font-size: 1.1rem; border-radius: 2rem; }
        .feature-icon { width: 50px; height: 50px; background: #6f42c1; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; }
    </style>
</head>
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">
                <div class="download-card p-5 text-center">
                    <!-- App Icon -->
                    <img src="../uploads/logo.png" alt="FMC Payments" class="app-icon mb-4" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                    <div style="display: none;" class="app-icon-fallback mb-4">
                        <div class="app-icon bg-primary d-flex align-items-center justify-content-center text-white">
                            <i class="fas fa-church fa-3x"></i>
                        </div>
                    </div>
                    
                    <h1 class="mb-3">FMC Payments</h1>
                    <p class="text-muted mb-4">Freeman Methodist Church Ghana<br>Mobile Payment App</p>
                    
                    <!-- Download Options -->
                    <div class="mb-4">
                        <h5 class="mb-3">Download Options</h5>
                        
                        <!-- PWA Install -->
                        <div class="alert alert-info mb-3">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-globe fa-2x me-3 text-primary"></i>
                                <div class="text-start flex-grow-1">
                                    <strong>Web App (Recommended)</strong><br>
                                    <small>Install directly from your browser - works on all devices</small>
                                </div>
                                <a href="index.html" class="btn btn-primary">
                                    <i class="fas fa-external-link-alt me-1"></i>Open App
                                </a>
                            </div>
                        </div>
                        
                        <!-- APK Download -->
                        <div class="alert alert-success mb-3">
                            <div class="d-flex align-items-center">
                                <i class="fab fa-android fa-2x me-3 text-success"></i>
                                <div class="text-start flex-grow-1">
                                    <strong>Android APK</strong><br>
                                    <small>Direct APK download for Android devices</small>
                                </div>
                                <button class="btn btn-success" onclick="generateAPK()">
                                    <i class="fas fa-download me-1"></i>Generate APK
                                </button>
                            </div>
                        </div>
                        
                        <!-- QR Code -->
                        <div class="alert alert-light mb-3">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-qrcode fa-2x me-3"></i>
                                <div class="text-start flex-grow-1">
                                    <strong>QR Code</strong><br>
                                    <small>Scan to open on mobile device</small>
                                </div>
                                <button class="btn btn-outline-dark" onclick="showQRCode()">
                                    <i class="fas fa-qrcode me-1"></i>Show QR
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Features -->
                    <div class="row text-start mb-4">
                        <div class="col-12 mb-3">
                            <h6><i class="fas fa-star text-warning me-2"></i>App Features</h6>
                        </div>
                        <div class="col-6 mb-2">
                            <small><i class="fas fa-check text-success me-2"></i>Secure Mobile Payments</small>
                        </div>
                        <div class="col-6 mb-2">
                            <small><i class="fas fa-check text-success me-2"></i>Payment History</small>
                        </div>
                        <div class="col-6 mb-2">
                            <small><i class="fas fa-check text-success me-2"></i>Works Offline</small>
                        </div>
                        <div class="col-6 mb-2">
                            <small><i class="fas fa-check text-success me-2"></i>Easy Installation</small>
                        </div>
                    </div>
                    
                    <!-- Instructions -->
                    <div class="text-start">
                        <h6><i class="fas fa-info-circle text-info me-2"></i>Installation Instructions</h6>
                        <ol class="small text-muted">
                            <li><strong>Web App:</strong> Click "Open App" and look for the install prompt in your browser</li>
                            <li><strong>Android APK:</strong> Click "Generate APK", download, and install (enable "Unknown Sources" in settings)</li>
                            <li><strong>QR Code:</strong> Scan with your phone camera to open directly</li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- QR Code Modal -->
    <div class="modal fade" id="qrModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Scan QR Code</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body text-center">
                    <div id="qrcode" class="mb-3"></div>
                    <p class="text-muted">Scan this QR code with your phone camera to open the app</p>
                    <div class="alert alert-info">
                        <small>
                            <strong>URL:</strong><br>
                            <span id="app-url"></span>
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    
    <script>
        function generateAPK() {
            // Show loading
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>Generating...';
            btn.disabled = true;
            
            // Simulate APK generation (in reality, you'd use a service like PWABuilder)
            setTimeout(() => {
                // Create a simple APK download link
                const appUrl = window.location.origin + window.location.pathname.replace('download-app.html', 'index.html');
                const apkUrl = `https://www.pwabuilder.com/api/download?url=${encodeURIComponent(appUrl)}&platform=android`;
                
                // Create download link
                const link = document.createElement('a');
                link.href = apkUrl;
                link.target = '_blank';
                link.click();
                
                // Reset button
                btn.innerHTML = originalText;
                btn.disabled = false;
                
                // Show success message
                alert('APK generation started! You will be redirected to PWABuilder to download your APK.');
            }, 2000);
        }
        
        function showQRCode() {
            const appUrl = window.location.origin + window.location.pathname.replace('download-app.html', 'index.html');
            document.getElementById('app-url').textContent = appUrl;
            
            // Generate QR code
            const qrContainer = document.getElementById('qrcode');
            qrContainer.innerHTML = '';
            
            QRCode.toCanvas(qrContainer, appUrl, {
                width: 200,
                height: 200,
                margin: 2
            }, function (error) {
                if (error) console.error(error);
            });
            
            // Show modal
            new bootstrap.Modal(document.getElementById('qrModal')).show();
        }
    </script>
</body>
</html>
